<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Movie Library</title>
  <link rel="icon" type="image/x-icon" href="./favicon.ico">
  <link rel="stylesheet" href="./style/home.css">
  <link rel="stylesheet" href="./style/style.css">
</head>
<body>

  <!-- Sidebar will go here -->
  <div id="sidebar-container"></div>

  <!-- Header -->
  <div class="header-container">
    <div class="header-background"></div>
    <div class="header-text">Lil Petey's Films+</div>
  </div>

  <div class="intro-box">
    <pre>Hello and Welcome to Lil Petey's Films+! Here you can watch all movies made by the studio for free and no ads included. Information on other projects will also drop here when new info has released.
  
  Have fun!
  -Lil Petey</pre>
  </div>    

  <!-- Movie Gallery -->
  <div class="gallery" id="movie-gallery">
    <p style="color: gray;">Loading movies...</p>
  </div>

  <!-- Sidebar Loader -->
  <script src="./sidebar.js"></script>
  <script>
    fetch('./sidebar.html')
      .then(res => res.text())
      .then(html => {
        document.getElementById('sidebar-container').innerHTML = html;
      })
      .then(() => {
        initSidebar();
      });
  </script>

  <!-- Movie Loader -->
  <script>
    document.addEventListener('DOMContentLoaded', async () => {
      try {
        const res = await fetch('./data/movie_data.json');
        const movies = await res.json();
        const gallery = document.getElementById('movie-gallery');
        gallery.innerHTML = '';

        movies.forEach((movie, index) => {
          const card = document.createElement('div');
          card.className = 'movie-card';
          card.onclick = () => {
            window.location.href = `./movie.html?movie=${index}`;
          };

          const img = document.createElement('img');
          img.src = movie.thumbnail;
          img.alt = movie.title;

          const title = document.createElement('div');
          title.className = 'title';
          title.textContent = movie.title;

          card.appendChild(img);
          card.appendChild(title);
          gallery.appendChild(card);
        });
      } catch (err) {
        console.error("Failed to load movies:", err);
        const gallery = document.getElementById('movie-gallery');
        gallery.innerHTML = `<p style="color: red;">Could not load movie list.</p>`;
      }
    });
  </script>

</body>
</html>
